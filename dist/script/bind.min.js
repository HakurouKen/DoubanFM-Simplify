!function(a,b,c){a.bindPlayer=function(b){var d=c("#fm-player-container"),e=d.find("a.btn.heart"),f=d.find(".player");e.bind("click",function(){b.heart(c(this).toggleClass("hearted").hasClass("hearted")?!0:!1)}),b.bind("play",function(){var a=b.getSongInfo();1==a.like?e.addClass("hearted"):e.removeClass("hearted")}),d.find("a.btn.trash").bind("click",function(){b.trash()}),d.find("a.btn.next").bind("click",function(){b.next()}),d.find("a.btn.prev").bind("click",function(){b.prev()}),d.find(".btn.pause").bind("click",function(a){a.stopPropagation(),c(".player-container").addClass("paused"),b.pause()}),d.delegate(".player-container.paused","click",function(){c(this).removeClass("paused"),b.resume()}),d.find(".volume-wrapper").bind("click",function(d){d.stopPropagation(),d=d?d:a.event;var e=c(this).find(".volume"),f=(e.find(".current-volume"),(d.clientX-e.offset().left)/e.width());b.vol(100*f)}),d.find("div.player-wrapper").bind("click",function(c){c=c?c:a.event;var d=(c.clientX-f.offset().left)/f.width();b.jumpTo(100*d+"%")}),d.find(".cover").bind("click",function(){a.open(c(this).attr("data-album"))}),d.find(".loop").bind("click",function(){b.loop()?(b.loop(!1),c(this).removeClass("on").addClass("off").text("单曲循环：关")):(b.loop(!0),c(this).removeClass("off").addClass("on").text("单曲循环：开"))}),d.find(".download").bind("click",function(a){a.preventDefault(),chrome.extension.sendMessage({action:"download",url:this.href,name:this.title.replace("下载 : ","")+"."+(this.href.match(/\.\w+$/)||[""])[0].substr(1)},function(){})}),delete a.bindPlayer},a.bindChannel=function(b,d){var e=b.find("ul.channel-list"),f=b.find("ul.channel-list li.channel");e.delegate("li.channel","click",function(){var a,b,e;if(!c(this).hasClass("selected")){var a=f.filter(".selected").data("cid"),b=c(this).data("cid"),e=c(this).parent("ul.channel-list").data("area");d.changeChannel(a,b,e),f.removeClass("selected"),c(this).addClass("selected")}}),f.filter("[data-cid="+(d.getCurChannel()||0)+"]").addClass("selected"),delete a.channelBind},a.bindToggleBtn=function(b,d,e,f){function g(b,d,e){isOrginal?(d.fadeOut(1e3,function(){c(".player-container.paused").click(),b.fadeIn(1e3,function(){a.isOrginal=!1,c(a).trigger("resize")}),b.find("li[data-cid="+(channel.getCurChannel()||0)+"]").addClass("selected")}),e.html("")):(b.fadeOut(1e3,function(){c(".fm-player a.btn.pause").click(),d.find("#fm-section").css("margin-top","0px"),d.find("#fm-section2").css("margin-top","0px"),d.find("#fm-section-app-entry").css("margin-top","0px"),d.find("#fm-bg").css("margin-top","0px"),d.fadeIn(1e3,function(){a.isOrginal=!0})}),e.html(h))}var h=f.clone().wrap("<div></div>").parent().html();console.log(f.html()),c("#toggleView").click(function(){g(d,e,f)}),delete a.bindToggleBtn},a.bindHotkey=function(b,d){var e=c(b);c("body").bind("keydown",function(b){if(!a.isOrginal)switch(b.keyCode){case 70:e.find("a.heart").click();break;case 68:e.find("a.trash").click();break;case 83:e.find("a.next").click();break;case 66:e.find("a.prev").click();break;case 32:e.find(".player-container").hasClass("paused")?e.find(".player-container").click():e.find("a.pause").click();break;case 76:e.find("a.loop").click();break;case 87:e.find("a.download").click();break;case 39:d.jumpTo(d.getCurTime()+5);break;case 37:d.jumpTo(d.getCurTime()-5);break;case 38:d.volUp(5);break;case 40:d.volDown(5)}}),delete a.bindHotkey},a.bindLyric=function(b,d,e){var f=d.find(".fm-bar"),g=d.find("#fm-player-container");c(a).resize(function(){var a=f.height()-g.height()-parseInt(g.css("margin-top"))-parseInt(g.css("margin-bottom"));e.height(a-30),e.find(".lyric-wrapper").height(a-30-50)}),e.bind("mousewheel",function(a,c){b.fix(c/20)}),e.find(".download-lrc").bind("click",function(){var a=c(this).attr("link");a&&chrome.extension.sendMessage({action:"download",url:a,name:c(this).attr("filename")+".lrc"},function(){})}),delete bindLyric}}(window,document,jQuery);